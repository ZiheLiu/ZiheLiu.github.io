---
title: 平衡二叉树
date: 2020-03-05 19:42:00
categories:
	- algorithm
tags:
	- algorithm
mathjax: true
typora-root-url: ../..
---

二叉搜索树 的中序遍历是有序的。

#  性质

1. 对于一个节点，其左子树的值小于它的值，右子树的值大于它的值。
2. 对于一个节点，其左子树和右子树的高度之差不大于1。

# 旋转操作

1. 左旋
   - 根节点的右节点成为新根节点。
   - 旧根节点成为新根节点的左节点。
   - 新根节点本来的左节点成为旧根节点的右节点。
2. 右旋
   - 根节点的左节点成为新根节点。
   - 旧根节点成为新根节点的右节点。
   - 新根节点本来的右节点成为旧根节点的左节点。

# 插入

对于1个节点，插入值为val的节点后，看它是否已经平衡(balance = 左子树高度-右子树高度)，如果不平衡：

- balance >= 2，左子树多了节点。
  - 如果val比左子节点的值小，说明在左子节点的左子树里多了一个节点(LL)。
    - 对当前节点进行右旋操作。
  - 否则，说明在左子节点的右子树里多了一个节点(LR)。
    - 对左子节点进行左旋操作。
    - 随后，对当前节点进行右旋操作。
- balance <= -2，左子树多了节点。
  - 如果val比右子节点的值大，说明在右子节点的右子树里多了一个节点(RR)。
    - 对当前节点进行左旋操作。
  - 否则，说明在右子节点的左子树里多了一个节点(RL)。
    - 对右子节点进行右旋操作。
    - 随后，对当前节点进行左旋操作。

注意，

- 旋转之后，要更新旧根节点和新根节点的高度。
- 平衡之后，要更新当前节点的高度。

示意图

![avl](/images/avl.png)

# 删除

对于1个节点，要删除值为val的节点，首先找到对应的节点：

- 如果当前节点为空，说明树中不存在值为val的节点，返回空。
- 如果val比当前节点的值小，在左子树递归寻找。
- 如果val比当前节点的值大，在右子树递归寻找。
- 否则，找到了值为val的节点。

找到值为val的节点root后，要删除root节点：

- 如果root的左右子节点至少有 一个为空，删除root节点，新的root为那个不为空的子节点（或者为空）。
- 如果左右子节点都不为空，去root的右子树里找最小的元素（比val大的最小的元素），把找到的值赋给root，删除那个节点（递归调用这个函数）。

删除root节点后，要进行节点的平衡：

- 如果balance >= 2
  - 如果root左子节点的balance>=0，说明多的节点在左子节点的左子树里(LL)。
    - 对root进行右旋。
  - 否则，说明多的节点在左子节点的右子树里(LR)。
    - 对root的左子节点进行左旋。
    - 随后，对root进行右旋。
- 如果balance <= -2
  - 如果root右子节点的balance<0，说明多的节点在右子节点的右子树里(RR)。
    - 对root进行左旋。
  - 否则，说明多的节点在右子节点的左子树里(RL)。
    - 对root的右子节点进行右旋。
    - 随后，对root进行左旋。